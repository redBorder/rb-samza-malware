package net.redborder.samza.aerospike;

import org.apache.samza.config.Config;
import org.apache.samza.metrics.MetricsRegistry;
import org.apache.samza.system.SystemAdmin;
import org.apache.samza.system.SystemConsumer;
import org.apache.samza.system.SystemFactory;
import org.apache.samza.system.SystemProducer;
import org.apache.samza.util.SinglePartitionWithoutOffsetsSystemAdmin;

public class AerospikeSystemFactory implements SystemFactory{
    @Override
    public SystemConsumer getConsumer(String s, Config config, MetricsRegistry metricsRegistry) {
        throw new UnsupportedOperationException("Can't consume from a aerospike!");
    }

    @Override
    public SystemProducer getProducer(String metadata, Config config, MetricsRegistry metricsRegistry) {
        return new AerospikeSystemProducer(metadata, config);
    }

    @Override
    public SystemAdmin getAdmin(String s, Config config) {
        return new SinglePartitionWithoutOffsetsSystemAdmin();
    }
}
